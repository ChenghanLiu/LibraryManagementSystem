{"remainingRequest":"/Users/liuchenghan/Desktop/LibraryManagementSystem/front/node_modules/babel-loader/lib/index.js!/Users/liuchenghan/Desktop/LibraryManagementSystem/front/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/liuchenghan/Desktop/LibraryManagementSystem/front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liuchenghan/Desktop/LibraryManagementSystem/front/src/views/modules/borrow/list.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/liuchenghan/Desktop/LibraryManagementSystem/front/src/views/modules/borrow/list.vue","mtime":1772216176573},{"path":"/Users/liuchenghan/Desktop/LibraryManagementSystem/front/babel.config.js","mtime":1772135377447},{"path":"/Users/liuchenghan/Desktop/LibraryManagementSystem/front/node_modules/cache-loader/dist/cjs.js","mtime":1772203478686},{"path":"/Users/liuchenghan/Desktop/LibraryManagementSystem/front/node_modules/babel-loader/lib/index.js","mtime":1772203478957},{"path":"/Users/liuchenghan/Desktop/LibraryManagementSystem/front/node_modules/cache-loader/dist/cjs.js","mtime":1772203478686},{"path":"/Users/liuchenghan/Desktop/LibraryManagementSystem/front/node_modules/vue-loader/lib/index.js","mtime":1772203474026}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9yZWdlbmVyYXRvciBmcm9tICIvVXNlcnMvbGl1Y2hlbmdoYW4vRGVza3RvcC9MaWJyYXJ5TWFuYWdlbWVudFN5c3RlbS9mcm9udC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vcmVnZW5lcmF0b3IuanMiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiL1VzZXJzL2xpdWNoZW5naGFuL0Rlc2t0b3AvTGlicmFyeU1hbmFnZW1lbnRTeXN0ZW0vZnJvbnQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IuanMiOwppbXBvcnQgcmVxdWVzdCBmcm9tICdAL3V0aWxzL2h0dHAnOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHRhYmxlRGF0YTogW10sCiAgICAgIGRpYWxvZ1Zpc2libGU6IGZhbHNlLAogICAgICBib3Jyb3dEYXlzOiAxLAogICAgICBjdXJyZW50Qm9vazogbnVsbCwKICAgICAgcm9sZTogc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgncm9sZScpCiAgICB9OwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0TGlzdCgpOwogIH0sCiAgbWV0aG9kczogewogICAgZ2V0TGlzdDogZnVuY3Rpb24gZ2V0TGlzdCgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3IoKS5tKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIHJlczsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yKCkudyhmdW5jdGlvbiAoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0Lm4pIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIF9jb250ZXh0Lm4gPSAxOwogICAgICAgICAgICAgIHJldHVybiByZXF1ZXN0KHsKICAgICAgICAgICAgICAgIHVybDogJy90dXNodS9saXN0JywKICAgICAgICAgICAgICAgIG1ldGhvZDogJ2dldCcKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgIHJlcyA9IF9jb250ZXh0LnY7CiAgICAgICAgICAgICAgX3RoaXMudGFibGVEYXRhID0gcmVzLmRhdGEuZGF0YS5saXN0OwogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmEoMik7CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIG9wZW5Cb3Jyb3c6IGZ1bmN0aW9uIG9wZW5Cb3Jyb3cocm93KSB7CiAgICAgIHRoaXMuY3VycmVudEJvb2sgPSByb3c7CiAgICAgIHRoaXMuYm9ycm93RGF5cyA9IDE7CiAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9IHRydWU7CiAgICB9LAogICAgc3VibWl0Qm9ycm93OiBmdW5jdGlvbiBzdWJtaXRCb3Jyb3coKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoLyojX19QVVJFX18qL19yZWdlbmVyYXRvcigpLm0oZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgICAgdmFyIHVzZXJJZCwgcmVzOwogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3IoKS53KGZ1bmN0aW9uIChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0Mi5uKSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICB1c2VySWQgPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCd1c2VySWQnKTsKICAgICAgICAgICAgICBfY29udGV4dDIubiA9IDE7CiAgICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3QoewogICAgICAgICAgICAgICAgdXJsOiAnL3R1c2h1amlleXVlL2FkZCcsCiAgICAgICAgICAgICAgICBtZXRob2Q6ICdwb3N0JywKICAgICAgICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgICAgICAgdHVzaHVJZDogX3RoaXMyLmN1cnJlbnRCb29rLmlkLAogICAgICAgICAgICAgICAgICB5b25naHVJZDogdXNlcklkLAogICAgICAgICAgICAgICAgICB0dXNodWppZXl1ZVNoaWppYW46IF90aGlzMi5ib3Jyb3dEYXlzLAogICAgICAgICAgICAgICAgICB0dXNodWppZXl1ZVR5cGVzOiAxCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICByZXMgPSBfY29udGV4dDIudjsKICAgICAgICAgICAgICBpZiAocmVzLmRhdGEuY29kZSA9PT0gMCkgewogICAgICAgICAgICAgICAgX3RoaXMyLiRtZXNzYWdlLnN1Y2Nlc3MoJ+WAn+mYheaIkOWKnycpOwogICAgICAgICAgICAgICAgX3RoaXMyLmRpYWxvZ1Zpc2libGUgPSBmYWxzZTsKICAgICAgICAgICAgICAgIF90aGlzMi5nZXRMaXN0KCk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIF90aGlzMi4kbWVzc2FnZS5lcnJvcihyZXMuZGF0YS5tc2cpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYSgyKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMik7CiAgICAgIH0pKSgpOwogICAgfQogIH0KfTs="},{"version":3,"names":["request","data","tableData","dialogVisible","borrowDays","currentBook","role","sessionStorage","getItem","created","getList","methods","_this","_asyncToGenerator","_regenerator","m","_callee","res","w","_context","n","url","method","v","list","a","openBorrow","row","submitBorrow","_this2","_callee2","userId","_context2","tushuId","id","yonghuId","tushujieyueShijian","tushujieyueTypes","code","$message","success","error","msg"],"sources":["src/views/modules/borrow/list.vue"],"sourcesContent":["<template>\n  <div class=\"borrow-container\">\n    <el-card>\n      <div slot=\"header\">\n        <span>图书借阅</span>\n      </div>\n\n      <el-table :data=\"tableData\" border style=\"width: 100%\">\n        <el-table-column prop=\"tushuUuidNumber\" label=\"图书编号\"/>\n        <el-table-column prop=\"tushuName\" label=\"图书标题\"/>\n        <el-table-column prop=\"tushuZuozhe\" label=\"作者\"/>\n        <el-table-column prop=\"tushuNumber\" label=\"库存\"/>\n\n        <el-table-column label=\"操作\" width=\"120\">\n          <template slot-scope=\"scope\">\n            <el-button\n                v-if=\"role==='用户'\"\n                size=\"mini\"\n                type=\"primary\"\n                :disabled=\"scope.row.tushuNumber <= 0\"\n                @click=\"openBorrow(scope.row)\"\n            >\n              借阅\n            </el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n    </el-card>\n\n    <!-- 借阅弹窗 -->\n    <el-dialog title=\"借阅图书\" :visible.sync=\"dialogVisible\" width=\"30%\">\n      <el-form>\n        <el-form-item label=\"借阅天数\">\n          <el-input-number v-model=\"borrowDays\" :min=\"1\"/>\n        </el-form-item>\n      </el-form>\n\n      <span slot=\"footer\">\n        <el-button @click=\"dialogVisible=false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"submitBorrow\">确认借阅</el-button>\n      </span>\n    </el-dialog>\n\n  </div>\n</template>\n\n<script>\nimport request from '@/utils/http'\n\nexport default {\n  data() {\n    return {\n      tableData: [],\n      dialogVisible: false,\n      borrowDays: 1,\n      currentBook: null,\n      role: sessionStorage.getItem('role')\n    }\n  },\n  created() {\n    this.getList()\n  },\n  methods: {\n\n    async getList() {\n      const res = await request({\n        url: '/tushu/list',\n        method: 'get'\n      })\n      this.tableData = res.data.data.list\n    },\n\n    openBorrow(row) {\n      this.currentBook = row\n      this.borrowDays = 1\n      this.dialogVisible = true\n    },\n\n    async submitBorrow() {\n      const userId = sessionStorage.getItem('userId')\n\n      const res = await request({\n        url: '/tushujieyue/add',\n        method: 'post',\n        data: {\n          tushuId: this.currentBook.id,\n          yonghuId: userId,\n          tushujieyueShijian: this.borrowDays,\n          tushujieyueTypes: 1\n        }\n      })\n\n      if (res.data.code === 0) {\n        this.$message.success('借阅成功')\n        this.dialogVisible = false\n        this.getList()\n      } else {\n        this.$message.error(res.data.msg)\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\n.borrow-container {\n  padding: 20px;\n}\n</style>"],"mappings":";;AA+CA,OAAAA,OAAA;AAEA;EACAC,IAAA,WAAAA,KAAA;IACA;MACAC,SAAA;MACAC,aAAA;MACAC,UAAA;MACAC,WAAA;MACAC,IAAA,EAAAC,cAAA,CAAAC,OAAA;IACA;EACA;EACAC,OAAA,WAAAA,QAAA;IACA,KAAAC,OAAA;EACA;EACAC,OAAA;IAEAD,OAAA,WAAAA,QAAA;MAAA,IAAAE,KAAA;MAAA,OAAAC,iBAAA,cAAAC,YAAA,GAAAC,CAAA,UAAAC,QAAA;QAAA,IAAAC,GAAA;QAAA,OAAAH,YAAA,GAAAI,CAAA,WAAAC,QAAA;UAAA,kBAAAA,QAAA,CAAAC,CAAA;YAAA;cAAAD,QAAA,CAAAC,CAAA;cAAA,OACApB,OAAA;gBACAqB,GAAA;gBACAC,MAAA;cACA;YAAA;cAHAL,GAAA,GAAAE,QAAA,CAAAI,CAAA;cAIAX,KAAA,CAAAV,SAAA,GAAAe,GAAA,CAAAhB,IAAA,CAAAA,IAAA,CAAAuB,IAAA;YAAA;cAAA,OAAAL,QAAA,CAAAM,CAAA;UAAA;QAAA,GAAAT,OAAA;MAAA;IACA;IAEAU,UAAA,WAAAA,WAAAC,GAAA;MACA,KAAAtB,WAAA,GAAAsB,GAAA;MACA,KAAAvB,UAAA;MACA,KAAAD,aAAA;IACA;IAEAyB,YAAA,WAAAA,aAAA;MAAA,IAAAC,MAAA;MAAA,OAAAhB,iBAAA,cAAAC,YAAA,GAAAC,CAAA,UAAAe,SAAA;QAAA,IAAAC,MAAA,EAAAd,GAAA;QAAA,OAAAH,YAAA,GAAAI,CAAA,WAAAc,SAAA;UAAA,kBAAAA,SAAA,CAAAZ,CAAA;YAAA;cACAW,MAAA,GAAAxB,cAAA,CAAAC,OAAA;cAAAwB,SAAA,CAAAZ,CAAA;cAAA,OAEApB,OAAA;gBACAqB,GAAA;gBACAC,MAAA;gBACArB,IAAA;kBACAgC,OAAA,EAAAJ,MAAA,CAAAxB,WAAA,CAAA6B,EAAA;kBACAC,QAAA,EAAAJ,MAAA;kBACAK,kBAAA,EAAAP,MAAA,CAAAzB,UAAA;kBACAiC,gBAAA;gBACA;cACA;YAAA;cATApB,GAAA,GAAAe,SAAA,CAAAT,CAAA;cAWA,IAAAN,GAAA,CAAAhB,IAAA,CAAAqC,IAAA;gBACAT,MAAA,CAAAU,QAAA,CAAAC,OAAA;gBACAX,MAAA,CAAA1B,aAAA;gBACA0B,MAAA,CAAAnB,OAAA;cACA;gBACAmB,MAAA,CAAAU,QAAA,CAAAE,KAAA,CAAAxB,GAAA,CAAAhB,IAAA,CAAAyC,GAAA;cACA;YAAA;cAAA,OAAAV,SAAA,CAAAP,CAAA;UAAA;QAAA,GAAAK,QAAA;MAAA;IACA;EACA;AACA","ignoreList":[]}]}