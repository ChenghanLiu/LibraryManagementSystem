{"remainingRequest":"/Users/liuchenghan/Desktop/LibraryManagementSystem/front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liuchenghan/Desktop/LibraryManagementSystem/front/src/views/modules/borrow/list.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/liuchenghan/Desktop/LibraryManagementSystem/front/src/views/modules/borrow/list.vue","mtime":1772216176573},{"path":"/Users/liuchenghan/Desktop/LibraryManagementSystem/front/node_modules/cache-loader/dist/cjs.js","mtime":1772203478686},{"path":"/Users/liuchenghan/Desktop/LibraryManagementSystem/front/node_modules/babel-loader/lib/index.js","mtime":1772203478957},{"path":"/Users/liuchenghan/Desktop/LibraryManagementSystem/front/node_modules/cache-loader/dist/cjs.js","mtime":1772203478686},{"path":"/Users/liuchenghan/Desktop/LibraryManagementSystem/front/node_modules/vue-loader/lib/index.js","mtime":1772203474026}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCByZXF1ZXN0IGZyb20gJ0AvdXRpbHMvaHR0cCcKCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdGFibGVEYXRhOiBbXSwKICAgICAgZGlhbG9nVmlzaWJsZTogZmFsc2UsCiAgICAgIGJvcnJvd0RheXM6IDEsCiAgICAgIGN1cnJlbnRCb29rOiBudWxsLAogICAgICByb2xlOiBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdyb2xlJykKICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmdldExpc3QoKQogIH0sCiAgbWV0aG9kczogewoKICAgIGFzeW5jIGdldExpc3QoKSB7CiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHJlcXVlc3QoewogICAgICAgIHVybDogJy90dXNodS9saXN0JywKICAgICAgICBtZXRob2Q6ICdnZXQnCiAgICAgIH0pCiAgICAgIHRoaXMudGFibGVEYXRhID0gcmVzLmRhdGEuZGF0YS5saXN0CiAgICB9LAoKICAgIG9wZW5Cb3Jyb3cocm93KSB7CiAgICAgIHRoaXMuY3VycmVudEJvb2sgPSByb3cKICAgICAgdGhpcy5ib3Jyb3dEYXlzID0gMQogICAgICB0aGlzLmRpYWxvZ1Zpc2libGUgPSB0cnVlCiAgICB9LAoKICAgIGFzeW5jIHN1Ym1pdEJvcnJvdygpIHsKICAgICAgY29uc3QgdXNlcklkID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgndXNlcklkJykKCiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHJlcXVlc3QoewogICAgICAgIHVybDogJy90dXNodWppZXl1ZS9hZGQnLAogICAgICAgIG1ldGhvZDogJ3Bvc3QnLAogICAgICAgIGRhdGE6IHsKICAgICAgICAgIHR1c2h1SWQ6IHRoaXMuY3VycmVudEJvb2suaWQsCiAgICAgICAgICB5b25naHVJZDogdXNlcklkLAogICAgICAgICAgdHVzaHVqaWV5dWVTaGlqaWFuOiB0aGlzLmJvcnJvd0RheXMsCiAgICAgICAgICB0dXNodWppZXl1ZVR5cGVzOiAxCiAgICAgICAgfQogICAgICB9KQoKICAgICAgaWYgKHJlcy5kYXRhLmNvZGUgPT09IDApIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ+WAn+mYheaIkOWKnycpCiAgICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gZmFsc2UKICAgICAgICB0aGlzLmdldExpc3QoKQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzLmRhdGEubXNnKQogICAgICB9CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["list.vue"],"names":[],"mappings":";AA+CA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"list.vue","sourceRoot":"src/views/modules/borrow","sourcesContent":["<template>\n  <div class=\"borrow-container\">\n    <el-card>\n      <div slot=\"header\">\n        <span>图书借阅</span>\n      </div>\n\n      <el-table :data=\"tableData\" border style=\"width: 100%\">\n        <el-table-column prop=\"tushuUuidNumber\" label=\"图书编号\"/>\n        <el-table-column prop=\"tushuName\" label=\"图书标题\"/>\n        <el-table-column prop=\"tushuZuozhe\" label=\"作者\"/>\n        <el-table-column prop=\"tushuNumber\" label=\"库存\"/>\n\n        <el-table-column label=\"操作\" width=\"120\">\n          <template slot-scope=\"scope\">\n            <el-button\n                v-if=\"role==='用户'\"\n                size=\"mini\"\n                type=\"primary\"\n                :disabled=\"scope.row.tushuNumber <= 0\"\n                @click=\"openBorrow(scope.row)\"\n            >\n              借阅\n            </el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n    </el-card>\n\n    <!-- 借阅弹窗 -->\n    <el-dialog title=\"借阅图书\" :visible.sync=\"dialogVisible\" width=\"30%\">\n      <el-form>\n        <el-form-item label=\"借阅天数\">\n          <el-input-number v-model=\"borrowDays\" :min=\"1\"/>\n        </el-form-item>\n      </el-form>\n\n      <span slot=\"footer\">\n        <el-button @click=\"dialogVisible=false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"submitBorrow\">确认借阅</el-button>\n      </span>\n    </el-dialog>\n\n  </div>\n</template>\n\n<script>\nimport request from '@/utils/http'\n\nexport default {\n  data() {\n    return {\n      tableData: [],\n      dialogVisible: false,\n      borrowDays: 1,\n      currentBook: null,\n      role: sessionStorage.getItem('role')\n    }\n  },\n  created() {\n    this.getList()\n  },\n  methods: {\n\n    async getList() {\n      const res = await request({\n        url: '/tushu/list',\n        method: 'get'\n      })\n      this.tableData = res.data.data.list\n    },\n\n    openBorrow(row) {\n      this.currentBook = row\n      this.borrowDays = 1\n      this.dialogVisible = true\n    },\n\n    async submitBorrow() {\n      const userId = sessionStorage.getItem('userId')\n\n      const res = await request({\n        url: '/tushujieyue/add',\n        method: 'post',\n        data: {\n          tushuId: this.currentBook.id,\n          yonghuId: userId,\n          tushujieyueShijian: this.borrowDays,\n          tushujieyueTypes: 1\n        }\n      })\n\n      if (res.data.code === 0) {\n        this.$message.success('借阅成功')\n        this.dialogVisible = false\n        this.getList()\n      } else {\n        this.$message.error(res.data.msg)\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\n.borrow-container {\n  padding: 20px;\n}\n</style>"]}]}