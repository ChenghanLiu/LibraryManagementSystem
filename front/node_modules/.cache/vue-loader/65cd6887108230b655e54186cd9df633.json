{"remainingRequest":"/Users/liuchenghan/Desktop/LibraryManagementSystem/front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liuchenghan/Desktop/LibraryManagementSystem/front/src/views/login.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/liuchenghan/Desktop/LibraryManagementSystem/front/src/views/login.vue","mtime":1772220174906},{"path":"/Users/liuchenghan/Desktop/LibraryManagementSystem/front/node_modules/cache-loader/dist/cjs.js","mtime":1772203478686},{"path":"/Users/liuchenghan/Desktop/LibraryManagementSystem/front/node_modules/babel-loader/lib/index.js","mtime":1772203478957},{"path":"/Users/liuchenghan/Desktop/LibraryManagementSystem/front/node_modules/cache-loader/dist/cjs.js","mtime":1772203478686},{"path":"/Users/liuchenghan/Desktop/LibraryManagementSystem/front/node_modules/vue-loader/lib/index.js","mtime":1772203474026}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBtZW51IGZyb20gIkAvdXRpbHMvbWVudSI7CgpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHJ1bGVzRm9ybTogewogICAgICAgIHVzZXJuYW1lOiAiIiwKICAgICAgICBwYXNzd29yZDogIiIsCiAgICAgICAgcm9sZTogIiIKICAgICAgfSwKICAgICAgbWVudXM6IFtdLAogICAgICB0YWJsZU5hbWU6ICIiCiAgICB9OwogIH0sCgogIGNvbXB1dGVkOiB7CiAgICBiYWNrTG9naW5NZW51cygpIHsKICAgICAgcmV0dXJuICh0aGlzLm1lbnVzIHx8IFtdKS5maWx0ZXIoCiAgICAgICAgICBpdGVtID0+IGl0ZW0uaGFzQmFja0xvZ2luID09ICLmmK8iCiAgICAgICk7CiAgICB9CiAgfSwKCiAgbW91bnRlZCgpIHsKICAgIHRoaXMubWVudXMgPSBtZW51Lmxpc3QoKTsKICB9LAoKICBtZXRob2RzOiB7CiAgICByZWdpc3Rlcih0YWJsZU5hbWUpIHsKICAgICAgdGhpcy4kc3RvcmFnZS5zZXQoImxvZ2luVGFibGUiLCB0YWJsZU5hbWUpOwogICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IHBhdGg6ICIvcmVnaXN0ZXIiIH0pOwogICAgfSwKCiAgICBsb2dpbigpIHsKICAgICAgaWYgKCF0aGlzLnJ1bGVzRm9ybS51c2VybmFtZSkKICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcigi6K+36L6T5YWl55So5oi35ZCNIik7CiAgICAgIGlmICghdGhpcy5ydWxlc0Zvcm0ucGFzc3dvcmQpCiAgICAgICAgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIuivt+i+k+WFpeWvhueggSIpOwogICAgICBpZiAoIXRoaXMucnVsZXNGb3JtLnJvbGUpCiAgICAgICAgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIuivt+mAieaLqeinkuiJsiIpOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm1lbnVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKHRoaXMubWVudXNbaV0ucm9sZU5hbWUgPT0gdGhpcy5ydWxlc0Zvcm0ucm9sZSkgewogICAgICAgICAgdGhpcy50YWJsZU5hbWUgPSB0aGlzLm1lbnVzW2ldLnRhYmxlTmFtZTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy4kaHR0cCh7CiAgICAgICAgdXJsOiBgJHt0aGlzLnRhYmxlTmFtZX0vbG9naW4/dXNlcm5hbWU9JHt0aGlzLnJ1bGVzRm9ybS51c2VybmFtZX0mcGFzc3dvcmQ9JHt0aGlzLnJ1bGVzRm9ybS5wYXNzd29yZH1gLAogICAgICAgIG1ldGhvZDogInBvc3QiCiAgICAgIH0pLnRoZW4oKHsgZGF0YSB9KSA9PiB7CiAgICAgICAgaWYgKGRhdGEgJiYgZGF0YS5jb2RlID09PSAwKSB7CiAgICAgICAgICB0aGlzLiRzdG9yYWdlLnNldCgiVG9rZW4iLCBkYXRhLnRva2VuKTsKICAgICAgICAgIHRoaXMuJHN0b3JhZ2Uuc2V0KCJ1c2VySWQiLCBkYXRhLnVzZXJJZCk7CiAgICAgICAgICB0aGlzLiRzdG9yYWdlLnNldCgicm9sZSIsIHRoaXMucnVsZXNGb3JtLnJvbGUpOwogICAgICAgICAgdGhpcy4kc3RvcmFnZS5zZXQoInNlc3Npb25UYWJsZSIsIHRoaXMudGFibGVOYW1lKTsKICAgICAgICAgIHRoaXMuJHN0b3JhZ2Uuc2V0KCJhZG1pbk5hbWUiLCB0aGlzLnJ1bGVzRm9ybS51c2VybmFtZSk7CiAgICAgICAgICB0aGlzLiRyb3V0ZXIucmVwbGFjZSh7IHBhdGg6ICIvaW5kZXgvIiB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihkYXRhLm1zZyk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["login.vue"],"names":[],"mappings":";AAmDA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"login.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"login-root\">\n    <div class=\"login-card\">\n      <div class=\"title\">\n        <div class=\"title-main\">图书管理系统</div>\n        <div class=\"title-sub\">请使用账号密码登录</div>\n      </div>\n\n      <el-form label-position=\"left\" label-width=\"0px\">\n        <el-form-item>\n          <el-input\n              placeholder=\"请输入用户名\"\n              v-model=\"rulesForm.username\"\n          />\n        </el-form-item>\n\n        <el-form-item>\n          <el-input\n              placeholder=\"请输入密码\"\n              type=\"password\"\n              v-model=\"rulesForm.password\"\n          />\n        </el-form-item>\n\n        <el-form-item>\n          <div class=\"role-label\">角色</div>\n          <div class=\"role-options\">\n            <el-radio\n                v-for=\"item in backLoginMenus\"\n                :key=\"item.roleName\"\n                v-model=\"rulesForm.role\"\n                :label=\"item.roleName\"\n            >\n              {{ item.roleName }}\n            </el-radio>\n          </div>\n        </el-form-item>\n\n        <el-button type=\"primary\" class=\"login-btn\" @click=\"login\">\n          登录\n        </el-button>\n\n        <div class=\"actions\">\n          <span class=\"link\" @click=\"register('yonghu')\">用户注册</span>\n        </div>\n      </el-form>\n    </div>\n  </div>\n</template>\n\n<script>\nimport menu from \"@/utils/menu\";\n\nexport default {\n  data() {\n    return {\n      rulesForm: {\n        username: \"\",\n        password: \"\",\n        role: \"\"\n      },\n      menus: [],\n      tableName: \"\"\n    };\n  },\n\n  computed: {\n    backLoginMenus() {\n      return (this.menus || []).filter(\n          item => item.hasBackLogin == \"是\"\n      );\n    }\n  },\n\n  mounted() {\n    this.menus = menu.list();\n  },\n\n  methods: {\n    register(tableName) {\n      this.$storage.set(\"loginTable\", tableName);\n      this.$router.push({ path: \"/register\" });\n    },\n\n    login() {\n      if (!this.rulesForm.username)\n        return this.$message.error(\"请输入用户名\");\n      if (!this.rulesForm.password)\n        return this.$message.error(\"请输入密码\");\n      if (!this.rulesForm.role)\n        return this.$message.error(\"请选择角色\");\n\n      for (let i = 0; i < this.menus.length; i++) {\n        if (this.menus[i].roleName == this.rulesForm.role) {\n          this.tableName = this.menus[i].tableName;\n          break;\n        }\n      }\n\n      this.$http({\n        url: `${this.tableName}/login?username=${this.rulesForm.username}&password=${this.rulesForm.password}`,\n        method: \"post\"\n      }).then(({ data }) => {\n        if (data && data.code === 0) {\n          this.$storage.set(\"Token\", data.token);\n          this.$storage.set(\"userId\", data.userId);\n          this.$storage.set(\"role\", this.rulesForm.role);\n          this.$storage.set(\"sessionTable\", this.tableName);\n          this.$storage.set(\"adminName\", this.rulesForm.username);\n          this.$router.replace({ path: \"/index/\" });\n        } else {\n          this.$message.error(data.msg);\n        }\n      });\n    }\n  }\n};\n</script>\n\n<style scoped>\n/* 全屏强制覆盖 */\n.login-root {\n  position: fixed !important;\n  inset: 0 !important;\n  width: 100vw !important;\n  height: 100vh !important;\n  z-index: 999999 !important;\n\n  display: flex !important;\n  align-items: center !important;\n  justify-content: center !important;\n\n  background: #f5f6f8 !important;\n  box-sizing: border-box !important;\n  padding: 24px !important;\n}\n\n/* 登录卡片 */\n.login-card {\n  width: 380px;\n  max-width: 92vw;\n  background: #fff;\n  border-radius: 14px;\n  padding: 24px;\n  box-shadow: 0 12px 32px rgba(0, 0, 0, 0.06);\n  box-sizing: border-box;\n}\n\n.title {\n  text-align: center;\n  margin-bottom: 20px;\n}\n\n.title-main {\n  font-size: 20px;\n  font-weight: 600;\n  color: #111827;\n}\n\n.title-sub {\n  font-size: 13px;\n  color: #6b7280;\n  margin-top: 6px;\n}\n\n.role-label {\n  font-size: 13px;\n  color: #6b7280;\n  margin-bottom: 6px;\n}\n\n.role-options {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 10px;\n}\n\n.login-btn {\n  width: 100%;\n  margin-top: 10px;\n  height: 40px;\n  border-radius: 8px;\n}\n\n.actions {\n  margin-top: 12px;\n  text-align: center;\n}\n\n.link {\n  font-size: 13px;\n  color: #409eff;\n  cursor: pointer;\n}\n</style>"]}]}